## 29. 模式匹配 (Pattern Matching) (Java 14+)

### 29.1. `instanceof` 的模式匹配 (`instanceof` Pattern Matching)

- **知识点：** `instanceof` 运算符的增强；简化类型转换和空检查；可读性提高。
- **注意：** 模式匹配 for `instanceof` 是 Java 14 的预览特性，并在 Java 16 中成为标准特性。

1. 题目名称：

    改进类型检查和转换

   题目描述：

   - 编写一个方法 `processShape(Object obj)`。
   - 在该方法中使用 `instanceof` 模式匹配来判断传入的对象是否是 `Circle` 或 `Rectangle` 的实例。
   - 如果是 `Circle`，则打印其半径；如果是 `Rectangle`，则打印其宽度和高度。
   - 比较使用传统 `instanceof` 和模式匹配的两种写法。 **参考代码结构：**

   ```java
   // Shape.java, Circle.java, Rectangle.java (与之前工厂模式的Shape类似，但为简单起见，这里假设直接在Main中定义)
   interface Shape {}
   
   class Circle implements Shape {
       private double radius;
       public Circle(double radius) { this.radius = radius; }
       public double getRadius() { return radius; }
   }
   
   class Rectangle implements Shape {
       private double width;
       private double height;
       public Rectangle(double width, double height) {
           this.width = width;
           this.height = height;
       }
       public double getWidth() { return width; }
       public double getHeight() { return height; }
   }
   
   public class PatternMatchingInstanceofDemo {
   
       // 使用传统 instanceof
       public static void processShapeTraditional(Object obj) {
           System.out.println("--- Processing (Traditional) ---");
           if (obj instanceof Circle) {
               Circle circle = (Circle) obj; // 需要显式类型转换
               System.out.println("Found a Circle with radius: " + circle.getRadius());
           } else if (obj instanceof Rectangle) {
               Rectangle rect = (Rectangle) obj; // 需要显式类型转换
               System.out.println("Found a Rectangle with width: " + rect.getWidth() + " and height: " + rect.getHeight());
           } else {
               System.out.println("Unknown shape: " + obj.getClass().getSimpleName());
           }
       }
   
       // 使用 instanceof 模式匹配 (Java 16+)
       public static void processShapePatternMatching(Object obj) {
           System.out.println("--- Processing (Pattern Matching) ---");
           // 在这里编写你的模式匹配逻辑
           if (obj instanceof Circle circle) { // 自动绑定到 circle 变量
               System.out.println("Found a Circle with radius: " + circle.getRadius());
           } else if (obj instanceof Rectangle rect) { // 自动绑定到 rect 变量
               System.out.println("Found a Rectangle with width: " + rect.getWidth() + " and height: " + rect.getHeight());
           } else {
               System.out.println("Unknown shape: " + obj.getClass().getSimpleName());
           }
       }
   
       public static void main(String[] args) {
           Shape circle = new Circle(10.0);
           Shape rectangle = new Rectangle(5.0, 8.0);
           String text = "Hello";
   
           processShapeTraditional(circle);
           processShapeTraditional(rectangle);
           processShapeTraditional(text);
   
           System.out.println("\n");
   
           processShapePatternMatching(circle);
           processShapePatternMatching(rectangle);
           processShapePatternMatching(text);
       }
   }
   ```